# Delete possibly remaining index
method: DELETE
endpoint: indexes/dyn
status_code: null
---
# Create index
method: POST
endpoint: indexes/
json:
  version: "0.6"
  index_id: dyn
  doc_mapping:
    mode: dynamic
    field_mappings:
      # array
      - name: ages
        type: array<u64>
      # not array
      - name: city
        type: text
      - name: objects
        type: array<object>
        field_mappings:
          - name: id
            type: text
            fast: true
    dynamic_mapping:
      fast: false
---
# Ingest documents
method: POST
endpoint: dyn/ingest
params:
  commit: force
ndjson:
  # We accept single value with no array for array type age
  - {"ages": 11}
  - {"ages": [12, 13]}
  # We accept multiple value for array type age with no arrays
  - {"city": "Paris"}
  - {"city": ["Paris", "London"]}
  # We map the inner field `objects.id`` to the right static type.
  - {"objects": [{"id": "obj5"}, {"id": "obj5b"}]}
  # It works if objects is not an array too
  - {"objects": {"id": "obj6"}}
  # Despite being under `objects`, `val` is mapped as dynamic.`
  - {"objects": {"val": 2}}
